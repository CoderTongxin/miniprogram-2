<!-- ç»Ÿè®¡åˆ†æ -->
<view class="page">
  <!-- å¤´éƒ¨ç»Ÿè®¡å¡ç‰‡ -->
  <view class="header-card">
    <text class="header-title">{{currentPeriodText}} æ€»æ”¯å‡º</text>
    <text class="header-amount">Â¥{{totalAmount}}</text>
    <view class="stats-row">
      <view class="stat-item">
        <text class="stat-value">{{totalCount}}</text>
        <text class="stat-label">ç”³è¯·æ€»æ•°</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{approvedCount}}</text>
        <text class="stat-label">å·²é€šè¿‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{approveRate}}%</text>
        <text class="stat-label">é€šè¿‡ç‡</text>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰å™¨ -->
  <view class="filter-card">
    <text class="filter-title">é€‰æ‹©æ—¶é—´èŒƒå›´</text>
    
    <!-- å¹´åº¦/æœˆåº¦åˆ‡æ¢ -->
    <view class="filter-tabs">
      <view 
        class="filter-tab {{periodType === 'year' ? 'active' : ''}}" 
        bindtap="onPeriodTypeChange" 
        data-type="year"
      >
        å¹´åº¦
      </view>
      <view 
        class="filter-tab {{periodType === 'month' ? 'active' : ''}}" 
        bindtap="onPeriodTypeChange" 
        data-type="month"
      >
        æœˆåº¦
      </view>
    </view>

    <!-- å¹´åº¦é€‰æ‹© -->
    <view wx:if="{{periodType === 'year'}}" class="period-grid">
      <view 
        wx:for="{{yearList}}" 
        wx:key="*this"
        class="period-item {{selectedYear === item ? 'active' : ''}}"
        bindtap="onYearChange"
        data-year="{{item}}"
      >
        {{item}}å¹´
      </view>
    </view>

    <!-- æœˆåº¦é€‰æ‹© -->
    <view wx:if="{{periodType === 'month'}}" class="period-grid">
      <view 
        wx:for="{{monthList}}" 
        wx:key="*this"
        class="period-item {{selectedMonth === item ? 'active' : ''}}"
        bindtap="onMonthChange"
        data-month="{{item}}"
      >
        {{item}}æœˆ
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»ç»Ÿè®¡ -->
  <view class="chart-card">
    <view class="card-header">
      <text class="card-title">ğŸ“Š åˆ†ç±»æ”¯å‡ºç»Ÿè®¡</text>
      <text class="card-subtitle">{{currentPeriodText}}</text>
    </view>
    
    <view class="type-stats">
      <view class="type-row" wx:for="{{typeStats}}" wx:key="type">
        <text class="type-label">{{item.name}}</text>
        <view class="type-bar-wrapper">
          <view class="type-bar" style="background: {{item.lightColor}};">
            <view 
              class="type-bar-fill" 
              style="width: {{item.percentage}}%; background: {{item.color}};"
            ></view>
          </view>
        </view>
        <text class="type-amount">Â¥{{item.amount}}</text>
      </view>
    </view>
  </view>

  <!-- æ”¯å‡ºè¶‹åŠ¿ -->
  <view class="chart-card">
    <text class="card-title">ğŸ“ˆ æ”¯å‡ºè¶‹åŠ¿</text>
    
    <view class="trend-list">
      <view class="trend-item" wx:for="{{trendData}}" wx:key="period">
        <text class="trend-period">{{item.period}}</text>
        <view class="trend-right">
          <text class="trend-amount">Â¥{{item.amount}}</text>
          <text class="trend-change {{item.change >= 0 ? 'up' : 'down'}}">
            {{item.change >= 0 ? '+' : ''}}{{item.change}}%
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ‘˜è¦ -->
  <view class="chart-card">
    <text class="card-title">ğŸ’¡ {{periodType === 'year' ? 'å¹´åº¦' : 'æœ¬æœˆ'}}ç»Ÿè®¡æ‘˜è¦</text>
    
    <view class="summary-grid">
      <view class="summary-card">
        <text class="summary-label">æ—¥å‡æ”¯å‡º</text>
        <text class="summary-value primary">Â¥{{avgDaily}}</text>
      </view>
      <view class="summary-card">
        <text class="summary-label">æœ€å¤§å•ç¬”</text>
        <text class="summary-value success">Â¥{{maxSingle}}</text>
      </view>
      <view class="summary-card">
        <text class="summary-label">æœ€å¸¸ç”³è¯·</text>
        <text class="summary-value warning">{{mostFrequent}}</text>
      </view>
      <view class="summary-card">
        <text class="summary-label">é©³å›æ¬¡æ•°</text>
        <text class="summary-value danger">{{rejectedCount}}</text>
      </view>
    </view>
  </view>
</view>
