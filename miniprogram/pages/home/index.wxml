<!-- é¦–é¡µ - è®¾è®¡ç³»ç»Ÿé‡æ„ç‰ˆ -->
<view class="ds-page ds-page--with-decor">
  
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡åŒº -->
  <view class="ds-main">
    <view class="ds-card ds-card--strong user-card">
      <view class="ds-row ds-row--between">
        <view class="ds-row" bindtap="goToSettings">
          <image class="user-avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
          <view class="user-text">
            <text class="ds-text-subtitle">{{userInfo.nickName}}</text>
            <text class="ds-text-desc">æ¬¢è¿å›æ¥ï½</text>
          </view>
        </view>
        <view class="stat-badge" bindtap="goToStatistics">
          <text class="stat-label">æœ¬æœˆæ”¯å‡º â†’</text>
          <text class="stat-amount">Â¥{{monthlyExpense}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- Tab æ ‡ç­¾æ  -->
  <t-tabs value="{{activeTab}}" bind:change="onTabChange" theme="line" class="tabs-container">
    <t-tab-panel label="æˆ‘çš„å¾…åŠ" value="todo" />
    <t-tab-panel label="æˆ‘çš„ç”³è¯·" value="myapply" />
    <t-tab-panel label="å·²å®Œæˆ" value="completed" />
  </t-tabs>

  <!-- ç­›é€‰æ  -->
  <view class="filter-section">
    <view class="filter-chip {{currentFilter === 'all' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="all">å…¨éƒ¨</view>
    <view class="filter-chip {{currentFilter === 'funds' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="funds">æ‹¨æ¬¾</view>
    <view class="filter-chip {{currentFilter === 'travel' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="travel">å‡ºè¡Œ</view>
    <view class="filter-chip {{currentFilter === 'other' ? 'active' : ''}}" bindtap="onFilterChange" data-filter="other">å…¶ä»–</view>
  </view>

  <!-- ç”µå­æµåˆ—è¡¨ -->
  <view class="flow-list">
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{flowList.length === 0}}" class="ds-empty">
      <text class="ds-empty__icon">ğŸ“‹</text>
      <text class="ds-empty__text">æš‚æ— æ•°æ®</text>
    </view>
    
    <!-- åˆ—è¡¨é¡¹ -->
    <view wx:else>
      <view class="flow-card ds-card" wx:for="{{flowList}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
        <view class="flow-header">
          <image class="flow-avatar" src="{{item.applicantAvatar}}" mode="aspectFill"></image>
          <view class="flow-info">
            <text class="flow-name">{{item.applicantName}}</text>
            <text class="flow-time">{{item.createTime}}</text>
          </view>
          <view class="flow-badges">
            <!-- çŠ¶æ€æ ‡ç­¾ -->
            <view class="ds-tag ds-tag--{{item.status === 'pending' ? 'yellow' : item.status === 'completed' ? 'success' : 'danger'}}">
              {{item.statusText}}
            </view>
          </view>
        </view>
        
        <view class="flow-content">{{item.content}}</view>
        
        <view class="flow-footer">
          <text class="flow-amount">Â¥{{item.amount}}</text>
          <view class="flow-type-tag ds-tag ds-tag--{{item.type}}">{{item.typeText}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ–°å»ºç”µå­æµæŒ‰é’® -->
  <view class="ds-fab" bindtap="goToCreate">
    <text style="font-size: 64rpx; color: #FFFFFF; font-weight: 300; position: relative; z-index: 1;height: 48px;">+</text>
  </view>

  <!-- Toast æç¤º -->
  <t-toast id="t-toast" />
</view>
