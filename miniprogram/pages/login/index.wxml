<!-- 准了么 - 登录页（像素级还原） -->
<view class="page">
  
  <!-- 背景装饰层 -->
  <view class="bg-decor">
    <view class="light-spot light-spot-1"></view>
    <view class="light-spot light-spot-2"></view>
    <view class="light-spot light-spot-3"></view>
    <view class="stars"></view>
  </view>

  <!-- 主容器卡片 -->
  <view class="main-card">
    
    <!-- 顶部 Logo 区 -->
    <view class="header">
      <image class="logo" src="/images/logo.png" mode="widthFix"></image>
      <text class="subtitle">先申请，再甜甜地批准~</text>
    </view>

    <!-- 卡片1：我的小档案 -->
    <view class="card card-profile">
      <view class="card-title-row">
        <view class="icon-dot"></view>
        <text class="card-title">我的小档案</text>
        <view class="title-decor"></view>
      </view>

      <!-- 未登录状态：显示头像昵称输入 -->
      <view wx:if="{{!isLoggedIn}}" class="profile-edit-content">
        <view class="avatar-edit-section">
          <button class="avatar-button" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
            <view class="avatar-placeholder">
              <image wx:if="{{avatarUrl}}" class="avatar-img" src="{{avatarUrl}}" mode="aspectFill"></image>
              <text wx:else class="avatar-hint">点击选择头像</text>
            </view>
          </button>
        </view>
        <view class="nickname-edit-section">
          <input 
            class="nickname-input" 
            type="nickname" 
            placeholder="请输入昵称" 
            value="{{nickName}}"
            bindinput="onNicknameInput"
            placeholder-class="nickname-placeholder"
          />
        </view>
      </view>

      <!-- 已登录状态：显示用户信息 -->
      <view wx:else class="profile-content" bindtap="onTapProfile">
        <view class="avatar-placeholder">
          <image wx:if="{{isLoggedIn && userInfo.avatarUrl}}" class="avatar-img" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        </view>
        <view class="profile-info">
          <text class="profile-name">{{isLoggedIn ? userInfo.nickName : '未登录'}}</text>
          <text class="profile-id">微信ID：{{isLoggedIn && userInfo._openid ? userInfo._openid.slice(0,3) + '...' : '---'}}</text>
        </view>
        <view class="profile-right">
          <view class="pill-status">已登录</view>
          <text class="arrow-icon">›</text>
        </view>
      </view>
    </view>

    <!-- 卡片2：伴侣绑定 -->
    <view class="card card-bind">
      <view class="card-title-row">
        <view class="icon-dot"></view>
        <text class="card-title">伴侣绑定</text>
        <view class="title-decor title-decor-small"></view>
      </view>

      <!-- 右上角小猪插画 -->
      <view class="pig-illustration">
        <view class="pig-heart"></view>
        <view class="pig-sparkle pig-sparkle-1"></view>
        <view class="pig-sparkle pig-sparkle-2"></view>
      </view>

      <view class="bind-content">
        <text class="bind-main-text">{{isBound ? '已绑定伴侣' : '还没有绑定伴侣哦～'}}</text>
        <text class="bind-sub-text">{{isBound ? '可以一起互相"审批"和互动。' : '绑定后才可以互相"审批"和互动。'}}</text>
      </view>

      <!-- 隐私协议复选框（仅未登录时显示） -->
      <view wx:if="{{!isLoggedIn}}" class="privacy-checkbox-section">
        <checkbox-group bindchange="onPrivacyChange">
          <label class="privacy-checkbox-label">
            <checkbox value="agree" checked="{{privacyAgreed}}" color="#F86585" />
          </label>
        </checkbox-group>
        <text class="privacy-text">我已阅读并同意</text>
            <text class="privacy-link" catchtap="onTapUserAgreement">《用户协议》《隐私政策》</text>
      </view>

      <!-- 主按钮 -->
      <view class="main-button" bindtap="onTapBind">
        <view class="button-highlight"></view>
        <text class="button-text">{{buttonText}} ›</text>
      </view>

      <!-- 协议提示区（已登录时显示） -->
      <view wx:if="{{isLoggedIn}}" class="agreement">
        <text class="agreement-text">已同意 </text>
        <text class="agreement-link" bindtap="onTapUserAgreement">《用户协议》</text>
        <text class="agreement-text"> 和 </text>
        <text class="agreement-link" bindtap="onTapPrivacy">《隐私政策》</text>
      </view>
    </view>

  </view>

</view>
