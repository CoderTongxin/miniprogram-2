<!-- 创建/编辑电子流 - 设计系统重构版 -->
<view class="ds-page ds-page--with-decor ds-safe-top ds-safe-bottom">
  
  <!-- 游客体验提示 -->
  <view wx:if="{{isDemo}}" class="guest-banner" bindtap="onGuestBannerTap">
    <text class="guest-banner__icon">👀</text>
    <text class="guest-banner__text">游客体验模式 · 登录后可提交真实申请</text>
    <text class="guest-banner__action">去登录 ›</text>
  </view>

  <view class="ds-main form-container">
    
    <!-- 申请内容 -->
    <view class="ds-card">
      <view class="ds-formItem">
        <text class="ds-formItem__label ds-formItem__label--required">申请内容</text>
        <textarea
          class="ds-textarea"
          value="{{formData.content}}"
          placeholder="请详细描述您的申请内容..."
          maxlength="500"
          bind:input="onContentChange"
          auto-height
        />
        <text class="ds-formItem__tip">建议说明申请的原因和用途，便于审批人了解</text>
      </view>
    </view>

    <!-- 申请金额 -->
    <view class="ds-card">
      <view class="ds-formItem">
        <text class="ds-formItem__label {{!isOtherType ? 'ds-formItem__label--required' : ''}}">申请金额</text>
        <view class="amount-wrapper">
          <text class="amount-prefix">¥</text>
          <input
            class="ds-input amount-input"
            type="digit"
            value="{{formData.amount}}"
            placeholder="0.00"
            bind:input="onAmountChange"
          />
        </view>
        <text wx:if="{{isOtherType}}" class="ds-formItem__tip" style="color: #F86585;">
          选择"其他"类型时，金额为选填项
        </text>
      </view>
    </view>

    <!-- 申请类型 -->
    <view class="ds-card">
      <view class="ds-formItem">
        <text class="ds-formItem__label ds-formItem__label--required">申请类型</text>
        <view class="type-grid">
          <view 
            class="type-item {{formData.type === 'funds' ? 'active' : ''}}" 
            bindtap="onTypeChange" 
            data-type="funds"
          >
            <text class="type-icon">💰</text>
            <text class="type-name">拨款</text>
          </view>
          <view 
            class="type-item {{formData.type === 'travel' ? 'active' : ''}}" 
            bindtap="onTypeChange" 
            data-type="travel"
          >
            <text class="type-icon">✈️</text>
            <text class="type-name">出行</text>
          </view>
          <view 
            class="type-item {{formData.type === 'other' ? 'active' : ''}}" 
            bindtap="onTypeChange" 
            data-type="other"
          >
            <text class="type-icon">📋</text>
            <text class="type-name">其他</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 审批人 -->
    <view class="ds-card">
      <view class="ds-formItem">
        <text class="ds-formItem__label">审批人</text>
        <view class="ds-card__content approver-card">
          <view class="ds-row">
            <image class="approver-avatar" src="{{approver.avatar || '/images/default_logo.png'}}" mode="aspectFill"></image>
            <view class="approver-info">
              <text class="ds-text-body">{{approver.name}}</text>
              <text class="ds-text-tip">默认审批人</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
  </view>

  <!-- 底部操作按钮 -->
  <view class="action-buttons">
    <button class="ds-btn-secondary btn-cancel" bind:tap="onCancel">
      <text class="ds-btn-text">取消</text>
    </button>
    <button class="ds-btn-primary btn-submit" bind:tap="onSubmit">
      <text class="ds-btn-text">提交申请</text>
    </button>
  </view>

  <!-- Toast 提示 -->
  <t-toast id="t-toast" />
</view>
